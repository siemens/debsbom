{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/siemens/debsbom/blob/main/src/debsbom/schema/schema-download.json",
  "title": "Download Result",
  "description": "The result of a download operation including the status, package name, package version, file name and file path.",
  "type": "object",
  "properties": {
    "status": {
      "description": "The status of the download operation.",
      "enum": ["ok", "not_found", "checksum_mismatch"]
    },
    "package": {
      "type": "object",
      "description": "An object identifying the package.",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the package."
        },
        "version": {
          "type": "string",
          "description": "The version of the package."
        },
        "purl": {
          "type": "string",
          "description": "The package url of the package."
        }
      },
      "required": ["name", "version", "purl"]
    },
    "filename": {
      "type": "string",
      "description": "The name of the processed file on success."
    },
    "path": {
      "type": "string",
      "description": "The absolute path to the downloaded file on success."
    }
  },
  "required": ["status"],
  "anyOf": [
    {
      "required": ["filename"]
    },
    {
      "required": ["package"]
    }
  ]
}
